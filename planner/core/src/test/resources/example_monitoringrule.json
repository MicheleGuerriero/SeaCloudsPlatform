["monitoringStuffModule1:\n  members: [module1]\n  policies:\n  - monitoringRules: |\n      <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n      <ns3:monitoringRules xmlns:ns2=\"http:\/\/www.modaclouds.eu\/xsd\/2.0\/grouping_categories_schema\" xmlns=\"http:\/\/www.modaclouds.eu\/xsd\/2.0\/aggregate_functions_schema\" xmlns:ns4=\"http:\/\/www.modaclouds.eu\/xsd\/2.0\/actions_schema\" xmlns:ns3=\"http:\/\/www.modaclouds.eu\/xsd\/1.0\/monitoring_rules_schema\" xmlns:ns5=\"http:\/\/www.modaclouds.eu\/xsd\/1.0\/metrics_schema\">\n          <ns3:monitoringRule id=\"cpuRule_Chat\" timeStep=\"10\" timeWindow=\"10\">\n              <ns3:monitoredTargets>\n                  <ns3:monitoredTarget type=\"Chat_VM\" class=\"VM\"\/>\n              <\/ns3:monitoredTargets>\n              <ns3:collectedMetric metricName=\"CPUUtilization\">\n                  <ns3:parameter name=\"samplingTime\">1<\/ns3:parameter>\n                  <ns3:parameter name=\"samplingProbability\">1<\/ns3:parameter>\n              <\/ns3:collectedMetric>\n              <ns3:metricAggregation groupingClass=\"VM\" aggregateFunction=\"Average\"\/>\n              <ns3:actions>\n                  <ns3:action name=\"OutputMetric\">\n                      <ns3:parameter name=\"metric\">AverageCpuUtilization_Chat<\/ns3:parameter>\n                      <ns3:parameter name=\"value\">METRIC<\/ns3:parameter>\n                      <ns3:parameter name=\"resourceId\">ID<\/ns3:parameter>\n                  <\/ns3:action>\n              <\/ns3:actions>\n          <\/ns3:monitoringRule>\n          <ns3:monitoringRule id=\"ramRule_Chat\" timeStep=\"10\" timeWindow=\"10\">\n              <ns3:monitoredTargets>\n                  <ns3:monitoredTarget type=\"Chat_VM\" class=\"VM\"\/>\n              <\/ns3:monitoredTargets>\n              <ns3:collectedMetric metricName=\"MemUsed\">\n                  <ns3:parameter name=\"samplingTime\">1<\/ns3:parameter>\n                  <ns3:parameter name=\"samplingProbability\">1<\/ns3:parameter>\n              <\/ns3:collectedMetric>\n              <ns3:metricAggregation groupingClass=\"VM\" aggregateFunction=\"Average\"\/>\n              <ns3:actions>\n                  <ns3:action name=\"OutputMetric\">\n                      <ns3:parameter name=\"metric\">AverageRamUtilization_Chat<\/ns3:parameter>\n                      <ns3:parameter name=\"value\">METRIC<\/ns3:parameter>\n                      <ns3:parameter name=\"resourceId\">ID<\/ns3:parameter>\n                  <\/ns3:action>\n              <\/ns3:actions>\n          <\/ns3:monitoringRule>\n          <ns3:monitoringRule id=\"respTimeRule_Chat\" timeStep=\"10\" timeWindow=\"10\">\n              <ns3:monitoredTargets>\n                  <ns3:monitoredTarget type=\"Chat\" class=\"InternalComponent\"\/>\n              <\/ns3:monitoredTargets>\n              <ns3:collectedMetric metricName=\"AvarageResponseTimeInternalComponent\"\/>\n              <ns3:actions>\n                  <ns3:action name=\"OutputMetric\">\n                      <ns3:parameter name=\"metric\">AvarageResponseTime_Chat<\/ns3:parameter>\n                      <ns3:parameter name=\"value\">METRIC<\/ns3:parameter>\n                      <ns3:parameter name=\"resourceId\">ID<\/ns3:parameter>\n                  <\/ns3:action>\n              <\/ns3:actions>\n          <\/ns3:monitoringRule>\n          <ns3:monitoringRule id=\"respTimeRule_InternalComponent\" timeStep=\"10\" timeWindow=\"10\">\n              <ns3:monitoredTargets>\n                  <ns3:monitoredTarget class=\"Method\"\/>\n              <\/ns3:monitoredTargets>\n              <ns3:collectedMetric metricName=\"EffectiveResponseTime\">\n                  <ns3:parameter name=\"samplingProbability\">1<\/ns3:parameter>\n              <\/ns3:collectedMetric>\n              <ns3:actions>\n                  <ns3:action name=\"OutputMetric\">\n                      <ns3:parameter name=\"metric\">AvarageResponseTimeInternalComponent<\/ns3:parameter>\n                      <ns3:parameter name=\"value\">METRIC<\/ns3:parameter>\n                      <ns3:parameter name=\"resourceId\">ID<\/ns3:parameter>\n                  <\/ns3:action>\n              <\/ns3:actions>\n          <\/ns3:monitoringRule>\n          <ns3:monitoringRule id=\"respTimeSLARule_Chat\" timeStep=\"10\" timeWindow=\"10\">\n              <ns3:monitoredTargets>\n                  <ns3:monitoredTarget type=\"Chat\" class=\"InternalComponent\"\/>\n              <\/ns3:monitoredTargets>\n              <ns3:collectedMetric metricName=\"AvarageResponseTimeInternalComponent\"\/>\n              <ns3:condition>METRIC &gt; 2000.0<\/ns3:condition>\n              <ns3:actions>\n                  <ns3:action name=\"OutputMetric\">\n                      <ns3:parameter name=\"metric\">AvarageResponseTime_Chat_Violation<\/ns3:parameter>\n                      <ns3:parameter name=\"value\">METRIC<\/ns3:parameter>\n                      <ns3:parameter name=\"resourceId\">ID<\/ns3:parameter>\n                  <\/ns3:action>\n              <\/ns3:actions>\n          <\/ns3:monitoringRule>\n          <ns3:monitoringRule id=\"vmAvailableSLARule_Chat\" timeStep=\"2\" timeWindow=\"2\">\n              <ns3:monitoredTargets>\n                  <ns3:monitoredTarget type=\"Chat\" class=\"InternalComponent\"\/>\n              <\/ns3:monitoredTargets>\n              <ns3:collectedMetric metricName=\"AppAvailable\"\/>\n              <ns3:metricAggregation groupingClass=\"InternalComponent\" aggregateFunction=\"Average\"\/>\n              <ns3:condition>METRIC &lt; 0.998<\/ns3:condition>\n              <ns3:actions>\n                  <ns3:action name=\"OutputMetric\">\n                      <ns3:parameter name=\"metric\">AvarageAppAvailability_Chat_Violation<\/ns3:parameter>\n                      <ns3:parameter name=\"value\">METRIC<\/ns3:parameter>\n                      <ns3:parameter name=\"resourceId\">ID<\/ns3:parameter>\n                  <\/ns3:action>\n              <\/ns3:actions>\n          <\/ns3:monitoringRule>\n      <\/ns3:monitoringRules>\n  - dataCollectorDeploymentScript: |\n      export MODACLOUDS_TOWER4CLOUDS_MANAGER_IP=127.0.0.1\n      export MODACLOUDS_TOWER4CLOUDS_MANAGER_PORT=8170\n      export MODACLOUDS_TOWER4CLOUDS_DC_SYNC_PERIOD=10\n      export MODACLOUDS_TOWER4CLOUDS_RESOURCES_KEEP_ALIVE_PERIOD=25\n      export MODACLOUDS_TOWER4CLOUDS_VM_TYPE=Chat_VM\n      export MODACLOUDS_TOWER4CLOUDS_INTERNAL_COMPONENT_TYPE=Chat\n      export MODACLOUDS_TOWER4CLOUDS_VM_ID=$brooklyn:formatString(\"%s%s\", Chat_VM,$brooklyn:component(\"Chat\").attributeWhenReady(\"host.address\"))export MODACLOUDS_TOWER4CLOUDS_INTERNAL_COMPONENT_ID=$brooklyn:formatString(\"%s%s\", Chat,$brooklyn:component(\"Chat\").attributeWhenReady(\"host.address\"))wget -O modaclouds-data-collector.jar https:\/\/github.com\/imperial-modaclouds\/modaclouds-data-collectors\/releases\/download\/2.0.4\/data-collector-22.0.4.jar\n      wget -O hyperic-sigar-1.6.4.zip http:\/\/sourceforge.net\/projects\/sigar\/files\/sigar\/1.6\/hypericsigar-1.6.4.zip\/download?use_mirror=switch\n      unzip hyperic-sigar-1.6.4.zip\n      nohup java -Djava.library.path=.\/hyperic-sigar-1.6.4\/sigar-bin\/lib\/ -jar modaclouds-data-collector.jar tower4clouds > dc.out 2>&1 &\n      echo $! > $PID_FILE\n",
"monitoringStuffModule2:\n  members: [module1]\n  policies:\n  - monitoringRules: |\n      <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n      <ns3:monitoringRules xmlns:ns2=\"http:\/\/www.modaclouds.eu\/xsd\/2.0\/grouping_categories_schema\" xmlns=\"http:\/\/www.modaclouds.eu\/xsd\/2.0\/aggregate_functions_schema\" xmlns:ns4=\"http:\/\/www.modaclouds.eu\/xsd\/2.0\/actions_schema\" xmlns:ns3=\"http:\/\/www.modaclouds.eu\/xsd\/1.0\/monitoring_rules_schema\" xmlns:ns5=\"http:\/\/www.modaclouds.eu\/xsd\/1.0\/metrics_schema\">\n          <ns3:monitoringRule id=\"cpuRule_Chat\" timeStep=\"10\" timeWindow=\"10\">\n              <ns3:monitoredTargets>\n                  <ns3:monitoredTarget type=\"Chat_VM\" class=\"VM\"\/>\n              <\/ns3:monitoredTargets>\n              <ns3:collectedMetric metricName=\"CPUUtilization\">\n                  <ns3:parameter name=\"samplingTime\">1<\/ns3:parameter>\n                  <ns3:parameter name=\"samplingProbability\">1<\/ns3:parameter>\n              <\/ns3:collectedMetric>\n              <ns3:metricAggregation groupingClass=\"VM\" aggregateFunction=\"Average\"\/>\n              <ns3:actions>\n                  <ns3:action name=\"OutputMetric\">\n                      <ns3:parameter name=\"metric\">AverageCpuUtilization_Chat<\/ns3:parameter>\n                      <ns3:parameter name=\"value\">METRIC<\/ns3:parameter>\n                      <ns3:parameter name=\"resourceId\">ID<\/ns3:parameter>\n                  <\/ns3:action>\n              <\/ns3:actions>\n          <\/ns3:monitoringRule>\n          <ns3:monitoringRule id=\"ramRule_Chat\" timeStep=\"10\" timeWindow=\"10\">\n              <ns3:monitoredTargets>\n                  <ns3:monitoredTarget type=\"Chat_VM\" class=\"VM\"\/>\n              <\/ns3:monitoredTargets>\n              <ns3:collectedMetric metricName=\"MemUsed\">\n                  <ns3:parameter name=\"samplingTime\">1<\/ns3:parameter>\n                  <ns3:parameter name=\"samplingProbability\">1<\/ns3:parameter>\n              <\/ns3:collectedMetric>\n              <ns3:metricAggregation groupingClass=\"VM\" aggregateFunction=\"Average\"\/>\n              <ns3:actions>\n                  <ns3:action name=\"OutputMetric\">\n                      <ns3:parameter name=\"metric\">AverageRamUtilization_Chat<\/ns3:parameter>\n                      <ns3:parameter name=\"value\">METRIC<\/ns3:parameter>\n                      <ns3:parameter name=\"resourceId\">ID<\/ns3:parameter>\n                  <\/ns3:action>\n              <\/ns3:actions>\n          <\/ns3:monitoringRule>\n          <ns3:monitoringRule id=\"respTimeRule_Chat\" timeStep=\"10\" timeWindow=\"10\">\n              <ns3:monitoredTargets>\n                  <ns3:monitoredTarget type=\"Chat\" class=\"InternalComponent\"\/>\n              <\/ns3:monitoredTargets>\n              <ns3:collectedMetric metricName=\"AvarageResponseTimeInternalComponent\"\/>\n              <ns3:actions>\n                  <ns3:action name=\"OutputMetric\">\n                      <ns3:parameter name=\"metric\">AvarageResponseTime_Chat<\/ns3:parameter>\n                      <ns3:parameter name=\"value\">METRIC<\/ns3:parameter>\n                      <ns3:parameter name=\"resourceId\">ID<\/ns3:parameter>\n                  <\/ns3:action>\n              <\/ns3:actions>\n          <\/ns3:monitoringRule>\n          <ns3:monitoringRule id=\"respTimeRule_InternalComponent\" timeStep=\"10\" timeWindow=\"10\">\n              <ns3:monitoredTargets>\n                  <ns3:monitoredTarget class=\"Method\"\/>\n              <\/ns3:monitoredTargets>\n              <ns3:collectedMetric metricName=\"EffectiveResponseTime\">\n                  <ns3:parameter name=\"samplingProbability\">1<\/ns3:parameter>\n              <\/ns3:collectedMetric>\n              <ns3:actions>\n                  <ns3:action name=\"OutputMetric\">\n                      <ns3:parameter name=\"metric\">AvarageResponseTimeInternalComponent<\/ns3:parameter>\n                      <ns3:parameter name=\"value\">METRIC<\/ns3:parameter>\n                      <ns3:parameter name=\"resourceId\">ID<\/ns3:parameter>\n                  <\/ns3:action>\n              <\/ns3:actions>\n          <\/ns3:monitoringRule>\n          <ns3:monitoringRule id=\"respTimeSLARule_Chat\" timeStep=\"10\" timeWindow=\"10\">\n              <ns3:monitoredTargets>\n                  <ns3:monitoredTarget type=\"Chat\" class=\"InternalComponent\"\/>\n              <\/ns3:monitoredTargets>\n              <ns3:collectedMetric metricName=\"AvarageResponseTimeInternalComponent\"\/>\n              <ns3:condition>METRIC &gt; 2000.0<\/ns3:condition>\n              <ns3:actions>\n                  <ns3:action name=\"OutputMetric\">\n                      <ns3:parameter name=\"metric\">AvarageResponseTime_Chat_Violation<\/ns3:parameter>\n                      <ns3:parameter name=\"value\">METRIC<\/ns3:parameter>\n                      <ns3:parameter name=\"resourceId\">ID<\/ns3:parameter>\n                  <\/ns3:action>\n              <\/ns3:actions>\n          <\/ns3:monitoringRule>\n          <ns3:monitoringRule id=\"vmAvailableSLARule_Chat\" timeStep=\"2\" timeWindow=\"2\">\n              <ns3:monitoredTargets>\n                  <ns3:monitoredTarget type=\"Chat\" class=\"InternalComponent\"\/>\n              <\/ns3:monitoredTargets>\n              <ns3:collectedMetric metricName=\"AppAvailable\"\/>\n              <ns3:metricAggregation groupingClass=\"InternalComponent\" aggregateFunction=\"Average\"\/>\n              <ns3:condition>METRIC &lt; 0.998<\/ns3:condition>\n              <ns3:actions>\n                  <ns3:action name=\"OutputMetric\">\n                      <ns3:parameter name=\"metric\">AvarageAppAvailability_Chat_Violation<\/ns3:parameter>\n                      <ns3:parameter name=\"value\">METRIC<\/ns3:parameter>\n                      <ns3:parameter name=\"resourceId\">ID<\/ns3:parameter>\n                  <\/ns3:action>\n              <\/ns3:actions>\n          <\/ns3:monitoringRule>\n      <\/ns3:monitoringRules>\n  - dataCollectorDeploymentScript: |\n      export MODACLOUDS_TOWER4CLOUDS_MANAGER_IP=127.0.0.1\n      export MODACLOUDS_TOWER4CLOUDS_MANAGER_PORT=8170\n      export MODACLOUDS_TOWER4CLOUDS_DC_SYNC_PERIOD=10\n      export MODACLOUDS_TOWER4CLOUDS_RESOURCES_KEEP_ALIVE_PERIOD=25\n      export MODACLOUDS_TOWER4CLOUDS_VM_TYPE=Chat_VM\n      export MODACLOUDS_TOWER4CLOUDS_INTERNAL_COMPONENT_TYPE=Chat\n      export MODACLOUDS_TOWER4CLOUDS_VM_ID=$brooklyn:formatString(\"%s%s\", Chat_VM,$brooklyn:component(\"Chat\").attributeWhenReady(\"host.address\"))export MODACLOUDS_TOWER4CLOUDS_INTERNAL_COMPONENT_ID=$brooklyn:formatString(\"%s%s\", Chat,$brooklyn:component(\"Chat\").attributeWhenReady(\"host.address\"))wget -O modaclouds-data-collector.jar https:\/\/github.com\/imperial-modaclouds\/modaclouds-data-collectors\/releases\/download\/2.0.4\/data-collector-22.0.4.jar\n      wget -O hyperic-sigar-1.6.4.zip http:\/\/sourceforge.net\/projects\/sigar\/files\/sigar\/1.6\/hyperic-sigar-1.6.4.zip\/download?use_mirror=switch\n      unzip hyperic-sigar-1.6.4.zip\n      nohup java -Djava.library.path=.\/hyperic-sigar-1.6.4\/sigar-bin\/lib\/ -jar modaclouds-data-collector.jar tower4clouds > dc.out 2>&1 &\n      echo $! > $PID_FILE\n"]

